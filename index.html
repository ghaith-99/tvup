<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تحدي كرة قدم - خمن اللاعب</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        /* كل أنماط CSS السابقة تبقى كما هي */
        * { box-sizing: border-box; font-family: 'Tajawal', Arial, sans-serif; }
        body { margin: 0; padding: 0; background-color: #f0f2f5; /* ... */ }
        /* ... (الصق هنا كل أنماط CSS من الكود الأصلي) ... */
    </style>
</head>
<body>
    <!-- باقي العناصر HTML تبقى كما هي -->
    <div id="notification"></div>

    <!-- صفحة تسجيل الدخول -->
    <div id="login-page" class="login-container">
        <!-- ... (نفس محتوى تسجيل الدخول) ... -->
    </div>

    <!-- الصفحة الرئيسية -->
    <div id="main-page" class="hidden">
        <!-- ... (نفس محتوى الصفحة الرئيسية) ... -->
    </div>

    <!-- مودال عرض الصورة -->
    <div id="image-modal" class="modal">
        <!-- ... (نفس محتوى المودال) ... -->
    </div>

    <script>
        // █████████████████████ خطوات ربط API █████████████████████
        // 1. أنشئ جدول Google Sheets جديد بعناوين الأعمدة التالية:
        // [id, name, age, nationality, type, clubs, image]
        // 2. اذهب إلى https://sheetdb.io وأنشئ حسابًا مجانيًا
        // 3. اختر "Create API" → "From Google Spreadsheet"
        // 4. اتبع الخطوات لربط جدولك مع SheetDB
        // 5. انسخ رابط الـ API الذي تحصل عليه (سيبدو كالتالي):
        const SHEETDB_API = 'https://sheetdb.io/api/v1/dvzme4zhxxf8n'; // ◀ استبدل هذا برابطك

        // █████████████████████ بيانات المستخدمين █████████████████████
        const users = [
            { username: "admin", password: "admin", isAdmin: true },
            { username: "user", password: "user", isAdmin: false }
        ];

        let currentUser = null;

        // █████████████████████ دوال النظام █████████████████████
async function showPlayers(type) {
    try {
        const response = await fetch(SHEETDB_API);
        if (!response.ok) throw new Error('فشل جلب البيانات');
        const players = await response.json();
        
        const container = document.getElementById('players-container');
        container.innerHTML = '';
        
        players.forEach(player => {
            // تأكد من أن الحقول تطابق جدولك
            const clubsHTML = player.clubs.split(',')
                .map(club => `<img src="/api/placeholder/25/25" alt="${club.trim()}" class="club-img">`)
                .join('');

            const playerCard = `
                <div class="player-card">
                    <img src="${player.image}" class="player-img">
                    <div class="player-info">
                        <div class="player-name">${player.name}</div>
                        <div class="player-details">
                            <div class="detail-item">
                                <span>العمر:</span>
                                <span>${player.age}</span>
                            </div>
                            <div class="detail-item">
                                <span>الجنسية:</span>
                                <img src="${player.nationalityImg}" class="flag-img">
                                <span>${player.nationality}</span>
                            </div>
                            <div class="detail-item">
                                <span>الأندية:</span>
                                <div class="clubs-container">${clubsHTML}</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            container.insertAdjacentHTML('beforeend', playerCard);
        });
    } catch (error) {
        console.error('Error:', error);
        alert('حدث خطأ في تحميل البيانات!');
    }
}
        async function addPlayer() {
            const newPlayer = {
                name: document.getElementById('player-name').value,
                age: document.getElementById('player-age').value,
                nationality: document.getElementById('player-nationality').value,
                type: document.getElementById('player-type').value,
                clubs: document.getElementById('player-clubs').value,
                image: document.getElementById('player-image').value || "default.jpg",
                nationalityImg: "/api/placeholder/25/25"
            };

            try {
                const response = await fetch(SHEETDB_API, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ data: [newPlayer] })
                });

                if (response.ok) {
                    alert('تمت الإضافة بنجاح!');
                    hideAddForm();
                    showPlayers(newPlayer.type);
                }
            } catch (error) {
                alert('فشل في الإضافة! تأكد من اتصال الإنترنت');
            }
        }

        // █████████████████████ الدوال المساعدة █████████████████████
        function login() { 
            const user = users.find(u => 
                u.username === document.getElementById('username').value &&
                u.password === document.getElementById('password').value
            );
            
            if (user) {
                currentUser = user;
                document.getElementById('login-page').classList.add('hidden');
                document.getElementById('main-page').classList.remove('hidden');
                if (user.isAdmin) document.getElementById('add-btn').style.display = 'inline-block';
                document.getElementById('user-info').textContent = `مرحباً، ${user.username} ${user.isAdmin ? '(مدير)' : ''}`;
                showPlayers('retired');
            } else {
                alert('بيانات الدخول غير صحيحة!');
            }
        }

        function logout() {
            currentUser = null;
            document.getElementById('login-page').classList.remove('hidden');
            document.getElementById('main-page').classList.add('hidden');
        }

        function openModal(src) {
            document.getElementById('image-modal').style.display = 'flex';
            document.getElementById('modal-img').src = src;
        }

        function closeModal() {
            document.getElementById('image-modal').style.display = 'none';
        }

        function showAddForm() {
            document.getElementById('add-form').style.display = 'block';
        }

        function hideAddForm() {
            document.getElementById('add-form').style.display = 'none';
        }
    </script>
</body>
</html>
